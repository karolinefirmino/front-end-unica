<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro</title>
    <link rel="stylesheet" href="./cadastro.css">
</head>
<header>
    <h1><a href="../index.html">Lispector Livraria</a></h1>
</header>

<body>
    <div id="buttons">
        <div class="button-box">
            <div id="btn"></div>
            <button id="bt1" type="button" class="toggle-btn" onclick="cpf()"><a href="cadastro-cnpj.html">Cadastrar com CNPJ</a></button>
        </div>
        <div id="error"></div>
    </div>
    <div class="container">
        <form id="Form1" class="form">
            <h3> INFORMAÇÕES PESSOAIS</h3>

            <div class="form-group">
                <input type="text" placeholder="CPF" id="cpf" name="cpf" required>
                <!-- <i class="fas fa-check-circle"></i>
                <i class="fas fa-exclamation-circle"></i> -->
                <small>Error</small>
            </div>

            <div class="form-group">
                <input type="text" placeholder="Nome" id="nome" name="nome" required>
                <!-- <i class="fas fa-check-circle"></i>
                <i class="fas fa-exclamation-circle"></i> -->
                <small>Error</small>
            </div>

            <div class="form-group">
            <input type="text" placeholder="Sobrenome" required id="sobrenome" name="sobrenome">
            <!-- <i class="fas fa-check-circle"></i>
                <i class="fas fa-exclamation-circle"></i> -->
            <small>Error</small>
            </div>

            <div class="btn-box">
                <button class="bnt-next-cad" type="button" id="Next1" name="Next1">Próximo</button>
                
            </div>

        </form>
        <form id="Form2" class="form">
            <h3> ENDEREÇO </h3>

            <div class="form-group">
            <input type="text" placeholder="CEP" id="cep" name="cep" required>
            <!-- <i class="fas fa-check-circle"></i>
                <i class="fas fa-exclamation-circle"></i> -->
            <small>Error</small>
            </div>

            <div class="form-group">
            <input type="text" placeholder="Número" id="numero" name="numero" required>
            <!-- <i class="fas fa-check-circle"></i>
                <i class="fas fa-exclamation-circle"></i> -->
            <small>Error</small>
            </div>

            <div class="form-group">
            <input type="text" placeholder="Complemento" id="complemento" name="complemento">
            <!-- <i class="fas fa-check-circle"></i>
            <i class="fas fa-exclamation-circle"></i>
            <small>Error</small> -->
            </div>
            <div class="btn-box">
                <button type="button" id="Back1" name="Back1">Voltar</button>
                <button class="bnt-next-cad" type="button" id="Next2" name="Back2">Próximo</button>
            </div>
        </form>
        <form id="Form3" class="form">
            <h3> CRIAR CONTA </h3>

            <div class="form-group">
            <input type="text" placeholder="Email" id="email" name="email" required>
            <!-- <i class="fas fa-check-circle"></i>
                <i class="fas fa-exclamation-circle"></i> -->
            <small>Error</small> 
            </div>

            <div class="form-group">
            <input type="password" placeholder="Senha" id="password" name="password" required>
            <!-- <i class="fas fa-check-circle"></i>
                <i class="fas fa-exclamation-circle"></i> -->
            <small>Error</small> 
            </div>

            <div class="form-group">
            <input type="password" placeholder="Confirmar Senha" id="confirmPass" name="confirmPass" required>
            <!-- <i class="fas fa-check-circle"></i>
                <i class="fas fa-exclamation-circle"></i> -->
            <small>Error</small> 
            </div>

            <div class="btn-box">
                <button type="button" id="Back2" name="Back2">Voltar</button>
                <button class="bnt-next-cad" type="button" id="Register" name="Register">Cadastrar</button>
            </div>
        </form>
        <div class="step-row">
            <div id="progress"></div>
            <div class="step-col"><small> Passo 1</small></div>
            <div class="step-col"><small> Passo 2</small></div>
            <div class="step-col"><small> Passo 3</small></div>
        </div>
        <script>
        var Form1 = document.getElementById("Form1");
        var Form2 = document.getElementById("Form2");
        var Form3 = document.getElementById("Form3");

        var Next1 = document.getElementById("Next1");
        var Next2 = document.getElementById("Next2");
        var Back1 = document.getElementById("Back1");
        var Back2 = document.getElementById("Back2");

        var progress = document.getElementById("progress");

        Next1.onclick = function() {
            Form1.style.left = "-450px";
            Form2.style.left = "40px";
            progress.style.width = "240px";
        }

        Back1.onclick = function() {
            Form1.style.left = "40px";
            Form2.style.left = "450px";
            progress.style.width = "120px";
        }

        Next2.onclick = function() {
            Form2.style.left = "-450px";
            Form3.style.left = "40px";
            progress.style.width = "360px";

        }

        Back2.onclick = function() {
            Form2.style.left = "40px";
            Form3.style.left = "450px";
            progress.style.width = "240px";
        }
        </script>

        <!--VALIDAÇÃO JAVASCRIPT-->

        <script>
        // Campos do Formulário (Início dos Inputs/Campos do Formulário))
        var cpf = window.document.getElementById('cpf')
        var nome = window.document.getElementById('nome')
        var sobrenome = window.document.getElementById('sobrenome')
        var cep = window.document.getElementById('cep')
        var numero = window.document.getElementById('numero')
        var complemento = window.document.getElementById('complemento')
        var email = document.getElementById('email')
        var password = document.getElementById('password')
        var confirmar = window.document.getElementById('confirmPass')
        // Fim dos Campos (Inputs do Formulário)
        // ------------------------------------------------------------------
        // Botões do formulário já estão definidas (Funções da seção anterior)
        // ------------------------------------------------------------------- 
        var button = document.querySelector('.bnt-next-cad')
        // ---------------------------------------------------
        var form = document.querySelector('.form')
        var errorElement = document.getElementById('error')
        // ------------------------------------------------------------------

        // Verificando se os campos estão preenchidos --> 
        // CPF 

        form.addEventListener('click', (e) => {
            let messages = []
            /*if (cpf.value.length == 0 || password.value == null || cpf.value.lenght < 11) 
        {
            
            console.log("CPF Inválido")
            messages.push('O campo cpf é obrigatório')
            alert('O campo cpf é obrigatório')
            console.log('O campo cpf está em branco')
            cpf.focus()
            errorElement.innerText = messages.join(', ')

        }

        // Validação de CPF com REGEX - INÍCIO - Verificando se há a quantidade de 11 caracteres e formato
        var cpfFormat =/^([0-9]{3}\.?[0-9]{3}\.?[0-9]{3}\-?[0-9]{2}|[0-9]{2}\.?[0-9]{3}\.?[0-9]{3}\/?[0-9]{4}\-?[0-9]{2})$/;
        if(cpf.value.lenght > 0 || cpf.value.match(cpfFormat)) 
        {
            console.log("CPF Válido!")
            true
        }
        else{
            console.log("CPF Inválido")
            messages.push('O campo cpf é obrigatório')
            alert('O campo cpf é obrigatório')
            console.log('O campo cpf está em branco')
            cpf.focus()
            errorElement.innerText = messages.join(', ')
        }
        // Verificação dos dígitos verificadores (Receita Federal)
        function validarCPF(inputCPF){
            var soma = 0;
            var resto;
            var inputCPF = document.getElementById('cpf').value;

            if(inputCPF == '00000000000') return false;
            for(i=1; i<=9; i++) soma = soma + parseInt(inputCPF.substring(i-1, i)) * (11 - i);
            resto = (soma * 10) % 11;

            if((resto == 10) || (resto == 11)) resto = 0;
            if(resto != parseInt(inputCPF.substring(9, 10))) return false;

            soma = 0;
            for(i = 1; i <= 10; i++) soma = soma + parseInt(inputCPF.substring(i-1, i))*(12-i);
            resto = (soma * 10) % 11;

            if((resto == 10) || (resto == 11)) resto = 0;
            if(resto != parseInt(inputCPF.substring(10, 11))) return false;
            return true;
            }*/
        
            e.preventDefault()
            
        // Fim da seção CPF - Fonte consultada/utilizada: https://pt.stackoverflow.com/questions/123741/validar-cpf-com-express%C3%A3o-regular-javascript
            
            checkInputs()
    })

    function checkInputs() {
        var cpfValue = cpf.value.trim()
        var nomeValue = nome.value.trim()
        var sobrenomeValue = sobrenome.value.trim()
        var cepValue = cep.value.trim()
        var numeroValue = numero.value.trim()
        var complementoValue = complemento.value.trim()
        var emailValue = email.value.trim()
        var passwordValue = password.value.trim()
        var confirmarValue = confirmar.value.trim()

        var cpfFormat = /(^\d{3}\.\d{3}\.\d{3}\-\d{2}$)|(^\d{2}\.\d{3}\.\d{3}\/\d{4}\-\d{2}$)/ ;
        if(cpfValue.lenght > 0 || cpf.value.match(cpfFormat)) {

            console.log("CPF Válido!")
            setSuccessFor(cpf)

        } else {
            // show error

            // add error class
        console.log("CPF Inválido!")
        setErrorFor(cpf, "CPF Inválido")
        cpf.focus()

        } 

        if(nomeValue === "") {
        console.log("Nome Inválido!")
        setErrorFor(nome, "O campo nome deve ter no mínimo 6 caracteres")
        nome.focus()
        } else{
            setSuccessFor(nome)
            console.log('Campo NOME válido/preenchido corretamente')
        }

        if(sobrenomeValue === "") {
        console.log("O campo Sobrenome é obrigatório.")
        setErrorFor(sobrenome, "O campo Sobrenome é obrigatório.")
        sobrenome.focus()
        } else{
            setSuccessFor(sobrenome)
            console.log('Campo SOBRENOME válido/preenchido corretamente')
        }

        var re = /\d{2}\.\d{3}\-\d{3}/
        if(cep.value.match(re) ){
            console.log("CEP Válido!")
            setSuccessFor(cep)
        } else{
            setErrorFor(cep, "CEP Inválido")
            console.log('CEP Inválido!')
            cep.focus()
        }

        if(numeroValue === "") {
            setErrorFor(numero, "O Campo Número é obrigatório.")
            console.log("O Campo Número é obrigatório.")
            numero.focus()
        }

        // Validação de Email com REGEX  
        var mailformat = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
        if(email.value.lenght > 0 || email.value.match(mailformat)){
                console.log("Email Válido!")
                setSuccessFor(email)
            } else
                {
                setErrorFor(email, "Email Inválido!")
                console.log("Email Inválido!")
                email.focus()
                }
        
        // Validacao de Senhas com REGEX 
        


    }

    /*var strCEP = document.getElementById("cep").value;
    cep.value = formatarCEP(strCEP);
    function formatarCEP(str){
	var re = /^([\d]{2})\.*([\d]{3})-*([\d]{3})/; // Pode usar ? no lugar do * \d{3}[.\s]?\d{3}[.\s]?\d{3}[-.\s]?\d{2}
    if(re.test(str)){
		return str.replace(re,"$1.$2-$3");
	}else{
		alert("CEP inválido!");
	}
	return "";*/

        function setErrorFor(input, message) {
            const formControl = input.parentElement //.form-control
            const small = formControl.querySelector('small')

            small.innerText = message

            formControl.className = "form-control error"
        }

        function setSuccessFor(input) {
            const formControl = input.parentElement
            formControl.className = "form-control success"

        }

    

        /*button.addEventListener('click', (e) => {
        let messages = []
        if (email.value === '' || email.value == null) {
            messages.push('O campo email é obrigatório')
            alert('O campo email é obrigatório')
        } 
        else {
              // Validação de Email com REGEX - INÍCIO 
            var mailformat = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
            var isValid = false;
            if(email.value.lenght > 0 || email.value.match(mailformat))
                {
                console.log("Email Válido!")
                true
                isValid = true
            }
        
            else
                {
                alert("Você inseriu um endereço de email inválido!!")
                console.log('O campo password está em branco')
                e.preventDefault()
                errorElement.innerText = messages.join(', ')
                isValid = false
                }

                if (password.value.length == 0 || password.value == null ) {
                    messages.push('O campo senha é obrigatório')
                    alert('O campo senha é obrigatório')
                    console.log('O campo password está em branco')
                    password.focus()
                    e.preventDefault()
                    errorElement.innerText = messages.join(', ')
                }
                if(password.value.length > 6) {
                    console.log('A senha é válida!')} 
                else {
                    console.log('A senha é inválida')
                    alert('Senha inválida')
                    console.log('A senhá foi preenchida, mas é inválida')
                    password.focus()
                    e.preventDefault()
                    errorElement.innerText = messages.join(', ')
                }
                }

    })*/

    </script>

</body>

</html>